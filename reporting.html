<html>
	<head>
		<link rel="stylesheet" type="text/css" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
		
		<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
		<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
	</head>

	<body>
		<form id="options" action='/' method='post'>
			<p>Date: <input type="text" id="datepicker" /></p>
			<p>Merchant ID: <input type="text" id="merchantID" value="mckenley1"/></p>
			<p>Report Type: 
			<select id="reportType" />
				<option value="PaymentBatchDetailReport">PaymentBatchDetailReport</option>
				<option value="TransactionDetailReport">TransactionDetailReport</option>
				<option value="PaymentEventsReport">PaymentEventsReport</option>
				<option value="TransactionExceptionDetailReport">TransactionExceptionDetailReport</option>
			</select>

			</p>
			<p>Report Format: 
			<select id="reportFormat" />
				<option value="xml">xml</option>
				<option value="csv">csv</option>
			</select>
			</br>
			<input type="submit" id="submit" />
		</form>
		<div id="results">
		</div>




		<script>
			var test = "https://ebctest.cybersource.com/ebctest/DownloadReport/"

    			


			var generateURL = function(){
				var date = new Date($( "#datepicker" ).val());
				var pad = function(n){return n<10 ? '0'+ n : n}
				return test
				+ pad(date.getFullYear()) + '/'
				+ pad(date.getMonth()) + '/'
				+ pad(date.getDate()) + '/'
				+ $('#merchantID').val() + '/'
				+ $('#reportType').val() + '.'
				+ $('#reportFormat').val();

			};

			var getData = function(){
				var params = {};
				var date = new Date($( "#datepicker" ).val());
				var pad = function(n){return n<10 ? '0'+ n : n}
				params.year = pad(date.getFullYear());
				params.month = pad(date.getMonth() + 1);
				params.day = pad(date.getDate());
				params.merchantID = $('#merchantID').val();
				params.reportType = $('#reportType').val();
				params.reportFormat = $('#reportFormat').val();

				return params;

			};

			$(document).ready(function(){
				$( "#datepicker" ).datepicker();
				$('#options').submit(function(event){
					event.preventDefault();
					console.log(generateURL());
					$.ajax({
						type: "POST",
						url: '/',
						data: JSON.stringify(getData()),
						//dataType: 'application/json',

						success: function(data, textStatus, jqXHR){
							$('#results').text(data.toString());
							console.log("Success!", textStatus, data);
						},
						error: function(jqXHR, textStatus){
							console.log("Failure!", textStatus);
						}
					});
				});

			});
		</script>
	</body>

</html>